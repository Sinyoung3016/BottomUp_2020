package authentication;

import java.sql.SQLException;
import database.DB_USER;
import exception.AuthenticationException;
import exception.MyException;
import User.Professor;

public class LogInContext {

	public synchronized static boolean SignUp(String ID, String Password, String Email) throws MyException, SQLException {
	
		if(AuthenticationException.IDFormCheck(ID)&&AuthenticationException.passwordFormCheck(Password)) {
			Professor getPro;
			getPro = DB_USER.getPro(ID);
			if (getPro != null) {	throw new MyException("중복되는 아이디가 있습니다.");
			}else {
			DB_USER.insertUser(ID, Password, Email);
			return true;
			}
		}
		return false;
	}

	

	public synchronized static boolean LogIn(String ID, String PW) throws MyException {
		Professor getPro;
		getPro = DB_USER.getPro(ID);

		if (getPro == null) {
			throw new MyException("존재하지 않는 ID입니다.");
		}
		if (PW.equals(getPro.getPassword())) {
			if(!getPro.is_connected()) {
				return true;//�α��� ����
			}
			else {
				throw new MyException("You are already logged in");
			}
		} else {//��й�ȣ�� �ٸ��ٸ�
			throw new MyException("Passwords do not match");
		}

	}
	

	public static void LogOut(String ID) {
		DB_USER.userLogOut(ID);
	}

}
