package authentication;

import java.sql.SQLException;
import database.DB_USER;
import Exception.AuthenticationException;
import Exception.MyException;
import User.Professor;

public class LogInContext {


	public synchronized static boolean SignUp(String Name, String Phone, String ID, String Password, String Emain	,String Address) throws MyException, SQLException {// È¸ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
	
		if(AuthenticationException.NameFormCheck(Name)&&AuthenticationException.phoneFormCheck(Phone)&&
				AuthenticationException.IDFormCheck(ID)&&AuthenticationException.passwordFormCheck(Password)) {//ï¿½ï¿½ï¿½Ä¿ï¿½ ï¿½Â´Ù¸ï¿½
			
			User getUser;
			getUser = DB_USER.getUser(ID);// ï¿½ßºï¿½ï¿½Ë»ï¿½ï¿½ï¿½ï¿½Ö´ï¿½ ï¿½Þ¼Òµï¿½ï¿½ï¿½ ï¿½ï¿½ï¿½Ï°ï¿½ï¿½ï¿½ ï¿½ï¿½Ð¹ï¿½È£ï¿½Ì´ï¿?, ï¿½ï¿½ï¿½ï¿½ ï¿½ßºï¿½ï¿½Ç¸ï¿½ nullï¿½ï¿½ï¿½ï¿½
			if (getUser != null) { // ï¿½ßºï¿½ï¿½È´Ù¸ï¿½
				throw new MyException("Already Exist ID");
			}else {
			DB_USER.insertUser(ID, Password, Name, Phone, Emain, Address, 1, 0);
			// È¸ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ ï¿½Ï·ï¿½
			return true;
			}
		}
		return false;
		
	}

	

	public synchronized static boolean LogIn(String ID, String PW) throws MyException {
		User getUser;
		getUser = DB_USER.getUser(ID);

		if (getUser == null) {// ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ ï¿½Ê´ï¿½ ï¿½ï¿½ï¿½Ìµï¿½ï¿½ï¿½
			throw new MyException("ID does not exist");
		}
		if (PW.equals(getUser.getPassword())) {
			//ï¿½ï¿½ï¿½ï¿½
			if(!getUser.is_connected()) {//ï¿½ï¿½ï¿½ï¿½Ç¾ï¿? ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ true, ï¿½Æ´Ï¸ï¿½ false
				return true;//ï¿½Î±ï¿½ï¿½ï¿½ ï¿½ï¿½ï¿½ï¿½
			}
			else {
				throw new MyException("You are already logged in");
			}
		} else {//ï¿½ï¿½Ð¹ï¿½È£ï¿½ï¿? ï¿½Ù¸ï¿½ï¿½Ù¸ï¿½
			throw new MyException("Passwords do not match");
		}

	}
	

	public static void LogOut(String ID) {
		DB_USER.userLogOut(ID);
	}

}
