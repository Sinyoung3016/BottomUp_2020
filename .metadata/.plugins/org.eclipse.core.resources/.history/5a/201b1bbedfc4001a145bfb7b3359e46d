package Authentication;

import java.sql.SQLException;
import database.DB_USER;
import Exception.AuthenticationException;
import Exception.MyException;
import User.Professor;

public class LogInContext {


	public synchronized static boolean SignUp(String Name, String Phone, String ID, String Password, String Emain	,String Address) throws MyException, SQLException {// ȸ������
	
		if(AuthenticationException.NameFormCheck(Name)&&AuthenticationException.phoneFormCheck(Phone)&&
				AuthenticationException.IDFormCheck(ID)&&AuthenticationException.passwordFormCheck(Password)) {//���Ŀ� �´ٸ�
			
			User getUser;
			getUser = DB_USER.getUser(ID);// �ߺ��˻����ִ� �޼ҵ��� ���ϰ��� ��й�ȣ�̴�, ���� �ߺ��Ǹ� null����
			if (getUser != null) { // �ߺ��ȴٸ�
				throw new MyException("Already Exist ID");
			}else {
			DB_USER.insertUser(ID, Password, Name, Phone, Emain, Address, 1, 0);
			// ȸ������ �Ϸ�
			return true;
			}
		}
		return false;
		
	}

	

	public synchronized static boolean LogIn(String ID, String PW) throws MyException {
		User getUser;
		getUser = DB_USER.getUser(ID);

		if (getUser == null) {// �������� �ʴ� ���̵���
			throw new MyException("ID does not exist");
		}
		if (PW.equals(getUser.getPassword())) {
			//����
			if(!getUser.is_connected()) {//����Ǿ� ������ true, �ƴϸ� false
				return true;//�α��� ����
			}
			else {
				throw new MyException("You are already logged in");
			}
		} else {//��й�ȣ�� �ٸ��ٸ�
			throw new MyException("Passwords do not match");
		}

	}
	

	public static void LogOut(String ID) {
		DB_USER.userLogOut(ID);
	}

}
